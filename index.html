<!DOCTYPE html>
<html>
<head>
  <title>PrismaX AI Quiz</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #0f172a;
      color: white;
      padding: 20px;
    }

    .quiz-box {
      max-width: 600px;
      margin: auto;
      background: #1e293b;
      padding: 20px;
      border-radius: 10px;
    }

    button {
      display: block;
      margin: 10px 0;
      padding: 12px;
      width: 100%;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      background: #334155;
      color: white;
      font-size: 16px;
    }

    button.selected {
      background: #6366f1;
    }

    select {
      padding: 8px;
      border-radius: 5px;
      margin: 10px 0;
    }
  </style>
</head>
<body>

<!-- Setup Screen -->
<div id="setup">
  <h2>Welcome to PrismaX AI Quiz!</h2>

  <p>Select number of questions:</p>
  <select id="numQuestions">
    <option value="10">10</option>
    <option value="20">20</option>
    <option value="50">50</option>
  </select>

  <p>Select mode:</p>
  <select id="mode">
    <option value="timer">Timer Mode</option>
    <option value="non-timer">Non-Timer Mode</option>
  </select>

  <button onclick="startQuiz()">Start Quiz</button>
</div>

<!-- Quiz Screen -->
<div class="quiz-box" id="quizBox" style="display:none;">
  <h2 id="question"></h2>
  <div id="answers"></div>
  <p id="timer" style="font-weight:bold;"></p>
</div>

<script>
const allQuestions = [
  { question: "What is PrismaX AI?", answers: ["A DeFi protocol", "A Social OS for AI & Robots", "An NFT marketplace"], correct: 1 },
  { question: "What does PrismaX focus on?", answers: ["Gaming", "Robotics coordination", "Meme coins"], correct: 1 },
  { question: "PrismaX helps robots do what?", answers: ["Dance", "Coordinate tasks", "Play games"], correct: 1 },
  { question: "Which industry does PrismaX target?", answers: ["Finance", "Robotics & AI", "Food"], correct: 1 },
  // ...add up to 1000 questions
];

let quiz = [];
let current = 0;
let selectedAnswer = null;
let userAnswers = [];
let timerInterval = null;
let mode = "non-timer";

function shuffleArray(array) {
  for (let i = array.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [array[i], array[j]] = [array[j], array[i]];
  }
  return array;
}

function startQuiz() {
  const num = parseInt(document.getElementById("numQuestions").value);
  mode = document.getElementById("mode").value;

  quiz = shuffleArray([...allQuestions]).slice(0, num);
  current = 0;
  selectedAnswer = null;
  userAnswers = [];

  document.getElementById("setup").style.display = "none";
  document.getElementById("quizBox").style.display = "block";

  loadQuestion();
}

function loadQuestion() {
  selectedAnswer = null;
  clearInterval(timerInterval);

  document.getElementById("question").innerText = quiz[current].question;
  const answersDiv = document.getElementById("answers");
  answersDiv.innerHTML = "";

  quiz[current].answers.forEach((answer, index) => {
    const btn = document.createElement("button");
    btn.innerText = answer;
    btn.onclick = () => selectAnswer(btn, index);
    answersDiv.appendChild(btn);
  });

  // start timer if timer mode
  if (mode === "timer") startTimer();
  else document.getElementById("timer").innerText = "";
}

function selectAnswer(button, index) {
  const buttons = document.querySelectorAll("#answers button");
  buttons.forEach(btn => btn.classList.remove("selected"));
  button.classList.add("selected");
  selectedAnswer = index;

  if (mode === "non-timer") {
    // auto advance after short delay
    setTimeout(nextQuestion, 500);
  }
}

function nextQuestion() {
  clearInterval(timerInterval);

  userAnswers.push({
    question: quiz[current].question,
    answers: quiz[current].answers,
    correct: quiz[current].correct,
    selected: selectedAnswer
  });

  current++;
  if (current < quiz.length) {
    loadQuestion();
  } else {
    showResults();
  }
}

// Timer logic
function startTimer() {
  let timeLeft = 10; // seconds per question
  const timerEl = document.getElementById("timer");
  timerEl.innerText = `Time left: ${timeLeft}s`;

  timerInterval = setInterval(() => {
    timeLeft--;
    timerEl.innerText = `Time left: ${timeLeft}s`;
    if (timeLeft <= 0) {
      clearInterval(timerInterval);
      nextQuestion();
    }
  }, 1000);
}

function showResults() {
  const quizBox = document.getElementById("quizBox");
  let score = 0;
  let resultsHTML = `<h2>Quiz Complete!</h2>`;

  userAnswers.forEach((q, i) => {
    const correctAnswer = q.answers[q.correct];
    const userAnswer = q.selected !== null ? q.answers[q.selected] : "(No answer)";
    if (q.selected === q.correct) score++;

    resultsHTML += `
      <div style="margin-bottom:15px;">
        <strong>Q${i + 1}: ${q.question}</strong><br>
        Your answer: ${userAnswer}<br>
        Correct answer: ${correctAnswer}<br>
      </div>
    `;
  });

  resultsHTML += `<h3>Your Score: ${score} / ${userAnswers.length}</h3>`;
  quizBox.innerHTML = resultsHTML;
}
</script>

</body>
</html>
